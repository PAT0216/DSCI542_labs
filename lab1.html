<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>DSCI 542 Lab 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="lab1_files/libs/clipboard/clipboard.min.js"></script>
<script src="lab1_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="lab1_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="lab1_files/libs/quarto-html/popper.min.js"></script>
<script src="lab1_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="lab1_files/libs/quarto-html/anchor.min.js"></script>
<link href="lab1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="lab1_files/libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="lab1_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="lab1_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="lab1_files/libs/bootstrap/bootstrap-8a894fcc3cb5e37eb5bf30def131be2f.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#lab-assignment-instructions" id="toc-lab-assignment-instructions" class="nav-link active" data-scroll-target="#lab-assignment-instructions">Lab Assignment Instructions</a></li>
  <li><a href="#question-1-asking-the-right-questions-12-pts" id="toc-question-1-asking-the-right-questions-12-pts" class="nav-link" data-scroll-target="#question-1-asking-the-right-questions-12-pts">Question 1: Asking the right questions (12 pts)</a></li>
  <li><a href="#question-2-outlining-6-points" id="toc-question-2-outlining-6-points" class="nav-link" data-scroll-target="#question-2-outlining-6-points">Question 2: Outlining (6 points)</a></li>
  <li><a href="#question-3-explain-complex-concepts-to-non-technical-audience-10-points" id="toc-question-3-explain-complex-concepts-to-non-technical-audience-10-points" class="nav-link" data-scroll-target="#question-3-explain-complex-concepts-to-non-technical-audience-10-points">Question 3: Explain complex concepts to non-technical audience (10 points)</a></li>
  <li><a href="#paper-trading-and-algorithmic-trading-the-why-and-how." id="toc-paper-trading-and-algorithmic-trading-the-why-and-how." class="nav-link" data-scroll-target="#paper-trading-and-algorithmic-trading-the-why-and-how.">Paper Trading and Algorithmic Trading: The Why and How.</a></li>
  <li><a href="#peer-feedback-to-be-completed-next-week" id="toc-peer-feedback-to-be-completed-next-week" class="nav-link" data-scroll-target="#peer-feedback-to-be-completed-next-week">Peer Feedback (to be completed next week)</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">DSCI 542 Lab 1</h1>
<p class="subtitle lead">Communicating in Data Science</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="lab-assignment-instructions" class="level2">
<h2 class="anchored" data-anchor-id="lab-assignment-instructions">Lab Assignment Instructions</h2>
<p>In this course, we are using a labor-based grading approach. This means that each task in the lab is graded based on completion rather than evaluation of quality. If a question is completed according to the specifications provided such as meeting the word limit, following the required format, or staying within the allotted time you will receive full credit for that question.</p>
<p>When submitting your lab, please be sure to:</p>
<ul>
<li><p>Include link to your GitHub repository containing your work.</p></li>
<li><p>Submit a the <code>.qmd</code> file along with a rendered version (either <code>.html</code> or <code>.pdf</code>) of your lab to Gradescope.</p></li>
<li><p>On Canvas, submit the link to your GitHub repository containing your work for peer review.</p></li>
</ul>
<p><strong>GitHub Repository:</strong> <a href="https://github.com/PAT0216/DSCI542_labs">https://github.com/PAT0216/DSCI542_labs</a></p>
</section>
<section id="question-1-asking-the-right-questions-12-pts" class="level2">
<h2 class="anchored" data-anchor-id="question-1-asking-the-right-questions-12-pts">Question 1: Asking the right questions (12 pts)</h2>
<p>rubric = {completion: 12}</p>
<p>An essential part of communication in data science is asking the ‘right’ questions. A good question should stem from a real business problem and reflect the direction of the analysis. As you will see later on in capstone projects, you will be often put in a situation where you need to translate a client’s business interests into a concrete &amp; specific question that determine the direction of the whole project. For example, the client might want to <strong>describe</strong> some existing patterns in the data, or they want to <strong>make inference</strong> to a wider population, or they want to <strong>predict</strong> some outcomes, or they might want to understand if certain interventions have a <strong>causal impact</strong> on some outcomes. You will need to read between the lines and identify what the client’s interests are to formulate a meaningful question.</p>
<p>In this exercise, you will be formulating different types of questions (<strong>descriptive, inferential, prediction, causal</strong>) to given problems.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 5%">
<col style="width: 55%">
<col style="width: 38%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Type</strong></th>
<th><strong>Description</strong></th>
<th><strong>Question</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Exploratory</td>
<td>A question that asks if there are patterns, trends, or relationships within a single data set. Often used to propose hypotheses for future study.</td>
<td>Does political party voting change with indicators of wealth in a set of data collected on 2,000 people living in Canada?</td>
</tr>
<tr class="even">
<td>Predictive</td>
<td>A question that asks about predicting measurements or labels for individuals (people or things). The focus is on what things predict some outcome, but not what causes the outcome.</td>
<td>What political party will someone vote for in the next Canadian election?</td>
</tr>
<tr class="odd">
<td>Inferential</td>
<td>A question that looks for patterns, trends, or relationships in a single data set and also asks for quantification of how applicable these findings are to the wider population.</td>
<td>Does political party voting change with indicators of wealth for all people living in Canada?</td>
</tr>
<tr class="even">
<td>Causal</td>
<td>A question that asks about whether changing one factor will lead to a change in another factor, on average, in the wider population.</td>
<td>Does wealth lead to voting for a certain political party in Canadian elections?</td>
</tr>
</tbody>
</table>
<blockquote class="blockquote">
<p>Source: https://datasciencebook.ca/intro.html#asking-a-question</p>
</blockquote>
<p>For questions 1.1-1.3, FORMAT YOUR ANSWER LIKE THIS:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Question</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Exploratory</td>
<td></td>
</tr>
<tr class="even">
<td>Predictive</td>
<td></td>
</tr>
<tr class="odd">
<td>Inferential</td>
<td></td>
</tr>
<tr class="even">
<td>Causal</td>
<td></td>
</tr>
</tbody>
</table>
<section id="problem-1-real-estate-marketing" class="level4">
<h4 class="anchored" data-anchor-id="problem-1-real-estate-marketing">1.1 Problem 1: Real estate marketing</h4>
<p>A digital real estate marketing firm is hiring you as a data science consultant. It offers a comprehensive list of for-sale properties, as well as the information and tools to make informed real estate decisions.</p>
<p>Return users are consumers who visit their website more than once. They may return for a variety of reasons such as to discover new homes, search for open houses, know about price reductions, check changes in status of previous homes of interest. These consumers form a very important segment of users since these are the ones we can expect to take more interest in our brand, be more engaged, loyal and, finally convert to a lead.</p>
<p>In this project we seek to build a data science/machine learning framework to find users that are likely to return and to develop strategies to encourage them to return to our website.</p>
<p><strong>ANSWER</strong>:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 56%">
<col style="width: 43%">
</colgroup>
<thead>
<tr class="header">
<th>Type</th>
<th>Question</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Exploratory</td>
<td>Are there any patterns in browsing behavior (like time spent or pages viewed) that differ between users who return and those who don’t?</td>
</tr>
<tr class="even">
<td>Predictive</td>
<td>Based on a user’s first visit behavior, can we predict whether they’ll come back to our website within the next 30 days?</td>
</tr>
<tr class="odd">
<td>Inferential</td>
<td>Do users who engage with price reduction alerts generally show higher return rates compared to the broader population of our website visitors?</td>
</tr>
<tr class="even">
<td>Causal</td>
<td>Does sending personalized “homes you might like” emails actually cause users to return to our website more often?</td>
</tr>
</tbody>
</table>
</section>
<section id="problem-2-sport-analytics" class="level4">
<h4 class="anchored" data-anchor-id="problem-2-sport-analytics">1.2 Problem 2: Sport analytics</h4>
<p>A professional basketball team is hiring you as a data science consultant. A primary mandate of this team is to inform decisions across several areas of Basketball Operations, including decisions about athletes’ physical preparation, injury prevention, return to sport, player identification/scouting, performance analysis, and opposition scouting.</p>
<p>The team collects a large amount of optical tracking data that records the x/y coordinates of all players and the ball at a frequency of 25 frames per second, while the event data records “on-ball” actions throughout the course of a match such as passes, shots.</p>
<p>In this project, we seek to apply a data science framework to enhance our players performance and develop effective squad formations that increase our chance of winning games.</p>
<p><strong>ANSWER</strong>:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 56%">
<col style="width: 43%">
</colgroup>
<thead>
<tr class="header">
<th>Type</th>
<th>Question</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Exploratory</td>
<td>What movement patterns or passing sequences tend to happen more often in games that we win versus games we lose?</td>
</tr>
<tr class="even">
<td>Predictive</td>
<td>Given the current lineup and play positioning, what’s the expected probability of scoring on this possession?</td>
</tr>
<tr class="odd">
<td>Inferential</td>
<td>Do players who follow our new training regimen show improved shot accuracy across all players in professional basketball?</td>
</tr>
<tr class="even">
<td>Causal</td>
<td>Does implementing a zone defense strategy actually lead to fewer opponent points compared to man-to-man defense?</td>
</tr>
</tbody>
</table>
</section>
<section id="problem-3-learning-analytics" class="level4">
<h4 class="anchored" data-anchor-id="problem-3-learning-analytics">1.3 Problem 3: Learning analytics</h4>
<p>Coursera is hiring you as a data science consultant. The company collects a large amount of event log data from learning management systems, in addition to academic records and personal information. Suppose that while these massive open online courses (MOOCs) have large enrollment, the completion rate has been observed to be rather small.</p>
<p>In this project, we are interested in identifying students who are at-risk of dropping out their course and how can we better retain these students.</p>
<p><strong>ANSWER</strong>:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 56%">
<col style="width: 43%">
</colgroup>
<thead>
<tr class="header">
<th>Type</th>
<th>Question</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Exploratory</td>
<td>Are there common patterns in how at-risk students interact with course materials compared to those who complete the course?</td>
</tr>
<tr class="even">
<td>Predictive</td>
<td>Can we predict which students are likely to drop out in the next two weeks based on their current engagement metrics?</td>
</tr>
<tr class="odd">
<td>Inferential</td>
<td>Is the relationship between video watch time and course completion rate generalizable to all MOOC learners, not just those in our sample?</td>
</tr>
<tr class="even">
<td>Causal</td>
<td>Do reminder notifications actually cause students to be more likely to complete their courses, or do engaged students just happen to respond to them?</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="question-2-outlining-6-points" class="level2">
<h2 class="anchored" data-anchor-id="question-2-outlining-6-points">Question 2: Outlining (6 points)</h2>
<p>rubric = {completion: 6}</p>
<p>In this course, we will spend a lot of time reflecting on how to clearly communicate ideas in data science. To begin, we would like you to choose any data science topic that interests you and create an outline for a short presentation on that topic.</p>
<p>At this stage, do not worry about making the outline perfect. For now, the goal is simply to sketch out the main sections and points you would include if you were giving a presentation about this topic.</p>
<blockquote class="blockquote">
<p><em>Note: Please think carefully about the topic you choose. This choice matters because it will not only shape the outline you create now, but will also be woven into different parts of the course as we practice communication skills. In fact, there’s a strong chance that the topic you select here will become the foundation for the presentation you deliver later.</em></p>
</blockquote>
<blockquote class="blockquote">
<p><em>Note: Used GenAI Gemini 3 pro for proofreading and formatting of content.</em></p>
</blockquote>
<p>Topic: Paper Trader AI - Building an Automated Trading System</p>
<p>I. Introduction</p>
<ul>
<li>What is paper trading?</li>
<li>Why it’s useful for learning</li>
</ul>
<ol start="2" type="I">
<li>The Problem</li>
</ol>
<ul>
<li>Emotional trading decisions</li>
<li>Time-consuming to monitor markets</li>
<li>Risky to test strategies with real money</li>
</ul>
<ol start="3" type="I">
<li>My Solution</li>
</ol>
<ul>
<li>Automated trading bot</li>
<li>Three different strategies (Momentum, ML, LSTM)</li>
<li>Daily automated execution</li>
</ul>
<ol start="4" type="I">
<li>Demo</li>
</ol>
<ul>
<li><p>Live dashboard walkthrough V. Results</p></li>
<li><p>Performance comparison</p></li>
<li><p>Key learnings</p></li>
</ul>
<ol start="6" type="I">
<li>Conclusion</li>
</ol>
<ul>
<li>Main takeaway</li>
<li>Limitations</li>
</ul>
</section>
<section id="question-3-explain-complex-concepts-to-non-technical-audience-10-points" class="level2">
<h2 class="anchored" data-anchor-id="question-3-explain-complex-concepts-to-non-technical-audience-10-points">Question 3: Explain complex concepts to non-technical audience (10 points)</h2>
<p>rubic = {completion: 20}</p>
<p>Explaining complex data science concepts to non-technical audience is a valuable skills set for any data scientists. By doing so, you can clearly communicate the results of their analysis and the insights they have gained, helping non-technical audiences to <strong>understand the significance and implications of their work</strong>. By writing clearly and concisely, data scientists can ensure that their ideas and insights are understood by their colleagues and that they can <strong>work together effectively</strong>. Finally, it can help you <strong>build credibility and trust with your colleagues</strong>, and demonstrate the value and relevance of your work.</p>
<p>Here are some tips for effective writing data science communication:</p>
<ul>
<li><strong>Be clear and concise</strong>: Avoid using jargon or overly technical language, and aim to explain concepts in a simple and straightforward manner.</li>
<li><strong>Use examples</strong>: Illustrate your points with examples or case studies to help make the material more relatable and easier to understand.</li>
<li><strong>Break down complex concepts</strong> If you are explaining a complex concept, break it down into smaller, more manageable pieces and explain each piece separately.</li>
<li><strong>Use visual aids</strong>: Use charts, graphs, or other visual aids to help clarify and illustrate your points.</li>
<li><strong>Ask for feedback</strong>: Review your writing carefully to ensure that it is accurate and well-organized, and ask for feedback from others if needed.</li>
</ul>
<p>In this exercise, you are tasked to explain your topic of choice to a non-technical audience (a type of activity that you will find yourself doing frequently later on when you work as a data scientist). For this exercise, you should be aiming for a character count of around 2500 (+ or - 500) characters, not including code, captions, references, etc. Please consider the amount of time it will take your audience to read your post (about 5-10 minutes). Consider the following points before diving into your write-up:</p>
<ul>
<li>Identify and highlight technical jargon and complex terms that might not be easy to understand by non-technical audiences. Please keep in mind the audience that you are writing for.</li>
<li>Refine the outline for your write-up.</li>
<li>Rewrite and explain the concept in a clear and concise way, creating additional visual aids if necessary.</li>
</ul>
<blockquote class="blockquote">
<p><em>Note: Used Gemini 3 Pro for proofreading and formatting of content/smoothing upto a certain extent.</em></p>
</blockquote>
</section>
<section id="paper-trading-and-algorithmic-trading-the-why-and-how." class="level2">
<h2 class="anchored" data-anchor-id="paper-trading-and-algorithmic-trading-the-why-and-how.">Paper Trading and Algorithmic Trading: The Why and How.</h2>
<p>What if you could Practice Investing Without Losing Money?</p>
<p>Most people are curious about investing but intimidated by the risk of losing money. This is where paper trading comes in. It is a method of simulating trades using fake money while tracking real market prices. Think of it as training wheels for the stock market. You get all the learning experience without any of the financial pain.</p>
<p>However, one major issue with traditional trading is that humans are emotional. When the market drops, people tend to panic and sell. When a stock is skyrocketing, greed kicks in and they buy at the peak. These emotional decisions often lead to poor results. Studies show that most individual investors actually underperform the market because of these behavioral mistakes.</p>
<p>This is why algorithmic trading has become so popular. Instead of making decisions based on gut feelings, an algorithm follows a set of predefined rules based purely on data. The algorithm doesn’t panic. It doesn’t get greedy. It simply executes the strategy it was programmed to follow.</p>
<p>One approach is called momentum trading, which is surprisingly simple: stocks that have been going up tend to keep going up, and stocks that have been falling tend to keep falling. However, a more advanced approach involves using Machine Learning to find hidden patterns in the data.</p>
<p>One popular machine learning method is called XGBoost. To understand how it works, imagine you are trying to guess whether it will rain tomorrow. You might ask a series of yes/no questions: Is it cloudy? Is the humidity high? Was it raining yesterday? Each question helps narrow down the answer. XGBoost works in a similar way. It builds hundreds of these “question trees” and combines their answers to make a final prediction. Each tree learns from the mistakes of the previous one, gradually improving accuracy. In trading, XGBoost can analyze factors like recent price movements, trading volume, and market trends to predict whether a stock will go up or down.</p>
<p>The beauty of machine learning is that it can spot patterns that humans might miss. However, it is not perfect. Just because a model worked on past data doesn’t mean it will work in the future. Markets change, and what worked yesterday may fail tomorrow. This is why testing strategies using paper trading is so important. You can see how the model performs in real conditions without risking actual money.</p>
<p>Additionally, it is important to understand transaction costs. Every time you buy or sell a stock, you pay a small fee. These fees seem tiny, maybe a few dollars, but they add up fast when you’re trading frequently. Many seemingly “profitable” strategies actually lose money in practice because the fees eat away at the returns.</p>
<p>To summarize, paper trading allows anyone to experiment with investing ideas safely. Machine learning, like XGBoost, can help find hidden patterns and make predictions. And understanding transaction costs reveals whether a strategy is truly profitable or just an illusion.</p>
</section>
<section id="peer-feedback-to-be-completed-next-week" class="level2">
<h2 class="anchored" data-anchor-id="peer-feedback-to-be-completed-next-week">Peer Feedback (to be completed next week)</h2>
<p>After the submission deadline, you will review your group member’s write ups.</p>
<p>Peer review allows you to receive feedback on your writing from multiple peers, which help you see your work more objectively and identify areas where they can revise and improve their writing. It also fosters a sense of community and a safe environment to collaborate and help each other with constructive feedback.</p>
<p>Read the write-ups from Question 3 carefully, paying attention to the content, organization, and style of the writing. Consider the following questions as you review:</p>
<ul>
<li>Is the content of the write-up accurate and well-researched?</li>
<li>Is the structure of the write-up clear and logical?</li>
<li>Are the ideas in the write-up effectively communicated and easy to understand?</li>
<li>Is the writing style of the write-up engaging and appropriate for the audience?</li>
</ul>
<p>Write a review for each of the write-ups, addressing the above questions and any other issues you feel are relevant. Use specific examples to support your points. Reviews should be <strong>at least 250 words</strong> in length. Please be sure your feedback is positive, constructive, and focused on helping your peers strengthen their work.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>